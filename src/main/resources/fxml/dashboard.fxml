<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.shape.SVGPath?>

<VBox spacing="20.0" styleClass="dashboard-container" xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.management.controller.DashboardController">
    <padding>
        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
    </padding>

    <!-- Welcome section -->
    <VBox spacing="5.0">
        <Label styleClass="welcome-title" text="Good Morning, Alexander!">
            <font>
                <Font name="System Bold" size="24.0" />
            </font>
        </Label>
        <Label styleClass="welcome-subtitle" text="Here's what's happening with your business today.">
            <font>
                <Font size="14.0" />
            </font>
        </Label>
    </VBox>

    <!-- Key metrics - top row -->
    <GridPane hgap="15.0" vgap="15.0">
        <columnConstraints>
            <ColumnConstraints hgrow="SOMETIMES" percentWidth="20.0" />
            <ColumnConstraints hgrow="SOMETIMES" percentWidth="20.0" />
            <ColumnConstraints hgrow="SOMETIMES" percentWidth="20.0" />
            <ColumnConstraints hgrow="SOMETIMES" percentWidth="20.0" />
            <ColumnConstraints hgrow="SOMETIMES" percentWidth="20.0" />
        </columnConstraints>
        <rowConstraints>
            <RowConstraints minHeight="110.0" prefHeight="130.0" vgrow="SOMETIMES" />
        </rowConstraints>

        <!-- Total Clients -->
        <VBox alignment="CENTER" styleClass="metric-card" GridPane.columnIndex="0">
            <SVGPath content="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
                     styleClass="metric-icon, clients-icon" />
            <Label styleClass="metric-title" text="Total Clients" />
            <Label fx:id="totalCustomersLabel" styleClass="metric-value, loading" text="--" />
        </VBox>

        <!-- Technicians -->
        <VBox alignment="CENTER" styleClass="metric-card" GridPane.columnIndex="1">
            <SVGPath content="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"
                     styleClass="metric-icon, technicians-icon" />
            <Label styleClass="metric-title" text="Technicians" />
            <Label fx:id="totalTechniciansLabel" styleClass="metric-value" text="15" />
        </VBox>

        <!-- Total Projects/Service Requests -->
        <VBox alignment="CENTER" styleClass="metric-card" GridPane.columnIndex="2">
            <SVGPath content="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm0 4c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm6 12H6v-1.4c0-2 4-3.1 6-3.1s6 1.1 6 3.1V19z"
                     styleClass="metric-icon, projects-icon" />
            <Label styleClass="metric-title" text="Total Projects" />
            <Label fx:id="activeServiceRequestsLabel" styleClass="metric-value" text="15" />
        </VBox>

        <!-- Unpaid Invoices/Pending Payments -->
        <VBox alignment="CENTER" styleClass="metric-card" GridPane.columnIndex="3">
            <SVGPath content="M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"
                     styleClass="metric-icon, invoices-icon" />
            <Label styleClass="metric-title" text="Unpaid Invoices" />
            <Label fx:id="pendingPaymentsLabel" styleClass="metric-value" text="7" />
        </VBox>

        <!-- Pending Tasks -->
        <VBox alignment="CENTER" styleClass="metric-card" GridPane.columnIndex="4">
            <SVGPath content="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z"
                     styleClass="metric-icon, tasks-icon" />
            <Label styleClass="metric-title" text="Pending Tasks" />
            <Label styleClass="metric-value" text="39" />
        </VBox>
    </GridPane>

    <!-- Second row of metrics -->
    <GridPane hgap="15.0" vgap="15.0">
        <columnConstraints>
            <ColumnConstraints hgrow="SOMETIMES" percentWidth="33.33" />
            <ColumnConstraints hgrow="SOMETIMES" percentWidth="33.33" />
            <ColumnConstraints hgrow="SOMETIMES" percentWidth="33.33" />
        </columnConstraints>
        <rowConstraints>
            <RowConstraints minHeight="110.0" prefHeight="130.0" vgrow="SOMETIMES" />
        </rowConstraints>

        <!-- Hours Logged -->
        <VBox alignment="CENTER" styleClass="metric-card" GridPane.columnIndex="0">
            <SVGPath content="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"
                     styleClass="metric-icon, hours-icon" />
            <Label styleClass="metric-title" text="Hours Logged" />
            <Label styleClass="metric-value, large-value" text="381 hrs 27 mins" />
        </VBox>

        <!-- Reports -->
        <VBox alignment="CENTER" styleClass="metric-card, action-metric" GridPane.columnIndex="1">
            <SVGPath content="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zM7 10h2v7H7zm4-3h2v10h-2zm4 6h2v4h-2z"
                     styleClass="metric-icon, reports-icon" />
            <Label styleClass="metric-title" text="Reports" />
            <Button styleClass="metric-action-button" text="Generate Report" onAction="#handleGenerateReport" />
        </VBox>

        <!-- Settings -->
        <VBox alignment="CENTER" styleClass="metric-card, action-metric" GridPane.columnIndex="2">
            <SVGPath content="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"
                     styleClass="metric-icon, settings-icon" />
            <Label styleClass="metric-title" text="Settings" />
            <Button styleClass="metric-action-button" text="System Settings" />
        </VBox>
    </GridPane>

    <Separator />

    <!-- Charts row -->
    <HBox spacing="15.0" VBox.vgrow="ALWAYS">
        <!-- Recent Earnings Chart -->
        <VBox spacing="10.0" styleClass="chart-container" HBox.hgrow="ALWAYS">
            <Label styleClass="chart-title" text="Recent Earnings">
                <font>
                    <Font name="System Bold" size="16.0" />
                </font>
            </Label>
            <AnchorPane styleClass="chart-placeholder" VBox.vgrow="ALWAYS">
                <Label styleClass="placeholder-text" text="Chart Placeholder"
                       AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0"
                       AnchorPane.topAnchor="0.0" AnchorPane.bottomAnchor="0.0" />
            </AnchorPane>
        </VBox>

        <!-- Tasks Performance Chart -->
        <VBox spacing="10.0" styleClass="chart-container" HBox.hgrow="ALWAYS">
            <Label styleClass="chart-title" text="Tasks Performance">
                <font>
                    <Font name="System Bold" size="16.0" />
                </font>
            </Label>
            <AnchorPane styleClass="chart-placeholder" VBox.vgrow="ALWAYS">
                <Label styleClass="placeholder-text" text="Chart Placeholder"
                       AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0"
                       AnchorPane.topAnchor="0.0" AnchorPane.bottomAnchor="0.0" />
            </AnchorPane>
        </VBox>
    </HBox>

    <!-- Quick Actions (can be uncommented if needed) -->
    <!--
    <VBox styleClass="quick-actions">
        <Label styleClass="section-title" text="Quick Actions">
            <font>
                <Font name="System Bold" size="16.0" />
            </font>
        </Label>
        <HBox spacing="15.0">
            <Button mnemonicParsing="false" onAction="#handleNewCustomer" styleClass="action-button" text="New Customer" />
            <Button mnemonicParsing="false" onAction="#handleNewTechnician" styleClass="action-button" text="New Technician" />
            <Button mnemonicParsing="false" onAction="#handleNewServiceRequest" styleClass="action-button" text="New Service Request" />
        </HBox>
    </VBox>
    -->
</VBox>